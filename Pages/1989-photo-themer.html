<!DOCTYPE html>

<html lang="en">
    <head>
        <title>1989 Photo Themer (Blue) | TS Fan Club</title>
        <link href="../Styles/style.css" rel="stylesheet">
        <meta charset="UTF-8">
        <!--Favicon Stuff-->
        <link rel="apple-touch-icon" sizes="180x180" href="../Favicon/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="../Favicon/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="../Favicon/favicon-16x16.png">
        <link rel="manifest" href="../Favicon/site.webmanifest">
        <link rel="mask-icon" href="../Favicon/safari-pinned-tab.svg" color="#35185a">
        <meta name="msapplication-TileColor" content="#35185a">
        <meta name="theme-color" content="#ffffff">
        <!--/Favicon Stuff-->
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <meta name="description" content="Taylor Swift Fan Club is the place you want to be for all things Taylor Alison Swift.">
        <meta name="keywords" content="taylorswift, music, fan, club, songs, musicindustry, games, fun, slay">
        <!--Important Font Information-->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
        <script src="https://kit.fontawesome.com/deec24d314.js" crossorigin="anonymous"></script>
        <link href="https://fonts.googleapis.com/css2?family=Permanent+Marker&display=swap" rel="stylesheet">
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-92RLWVWV1J"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-92RLWVWV1J');
        </script>
        <style>
        #upload-drop-area {
            border: 2px dashed #000;
            border-left: none;
            border-right: none;
            padding: 20px;
            text-align: center;
            color: 	#005b96;
            cursor: pointer;
        }
        </style>
    </head>
    <body style="background-color: #b7e6f8;">
        <header>
            <div class="topnav">
                <a class="underline-animation" href="/taylor-swift">Taylor Swift</a>
                <a class="underline-animation" href="/fearless">Fearless</a>
                <a class="underline-animation" href="/speak-now">Speak Now</a>
                <a class="underline-animation" href="/red">Red</a>
                <a class="underline-animation" href="/1989">1989</a>
                <div class="dropdown">
                    <button class="album-dropbtn dropbtn"><i class="fas fa-caret-down"></i></button>
                    <div class="dropdown-content">
                        <a href="/taylor-swift">Taylor Swift</a>
                        <a href="/fearless">Fearless</a>
                        <a href="/speak-now">Speak Now</a>
                        <a href="/red">Red</a>
                        <a href="/1989">1989</a>
                        <a href="/reputation">reputation</a>
                        <a href="/lover">Lover</a>
                        <a href="/folklore">folklore</a>
                        <a href="/evermore">evermore</a>
                        <a href="/midnights">Midnights</a>
                    </div>
                </div>
                <div class="dropdown">
                    <button class="dropbtn header-footer-icon"><i class="fas fa-globe"></i></button>
                    <div class="dropdown-content">
                        <a href="/singles"><button class="header-footer-icon"><i class="fas fa-tree"></i></button></a><span class="hide">Singles</span>
                        <a href="/unreleased"><button class="header-footer-icon"><i class="fas fa-key"></i></button></a><span class="hide">Unreleased</span>
                        <a href="/bridges"><button class="header-footer-icon"><i class="fas fa-bridge"></i></button></a><span class="hide">Bridges</span>
                        <a href="/tours"><button class="header-footer-icon"><i class="fas fa-microphone"></i></button></a><span class="hide">Tours</span>
                    </div>
                </div>
                <a href="/home"><img class="ts-icon" src="../Favicon/android-chrome-512x512.png" alt="TS Fan Club Icon"></a>
                <a class="header-footer-icon youtube" href="https://youtube.com/taylorswift" target="_blank"><i class="fa-brands fa-youtube"></i></a>
                <a class="header-footer-icon darkmode"><i class="fas fa-circle-half-stroke"></i></a>
                <a class="underline-animation" href="/reputation">reputation</a>
                <a class="underline-animation" href="/lover">Lover</a>
                <a class="underline-animation" href="/folklore">folklore</a>
                <a class="underline-animation" href="/evermore">evermore</a>
                <a class="underline-animation" href="/midnights">Midnights</a>
            </div>
        </header>
    <div class="main" style="display: flex; flex-direction: column; min-height: 100vh;">
        <main>
            <h1 class="make-it-blue-title">1989 Photo Themer (Make It Blue)</h1>
            <div id="upload-drop-area">
                <p>Drag and drop an image here, or click to upload.</p>
            </div>
            <input type="file" id="file-input" style="display: none;">
            <div id="filtered-image"></div>
            <a id="download-button" class="half-beautiful-box disguise" style="display: none; color: #183058;" download="1989-blue-filtered-image.png">
                <button>Download</button>
            </a>
            <a id="save-to-photos-mobile-button" class="half-beautiful-box disguise" style="display: none; color: #183058;">
                <button>Save to Photos (Mobile)</button>
            </a>
        </main>
        <footer>
            <div class="socials">
                <a class="social header-footer-icon" href="https://github.com/Corza-21/TS-Fan-Club" target="_blank"><i class="fas fa-code"></i></a>
                <a class="social header-footer-icon" href="https://www.facebook.com/TaylorSwift" target="_blank"><i class="fa-brands fa-facebook"></i></a>
                <a class="social header-footer-icon" href="https://www.instagram.com/taylorswift/" target="_blank"><i class="fa-brands fa-instagram"></i></a>
                <a class="social header-footer-icon" href="https://taylorswift.tumblr.com/" target="_blank"><i class="fa-brands fa-tumblr"></i></a>
                <a class="social header-footer-icon" href="https://twitter.com/taylorswift13" target="_blank"><i class="fa-brands fa-twitter"></i></a>
                <a class="social header-footer-icon" href="https://www.tiktok.com/@taylorswift" target="_blank"><i class="fa-brands fa-tiktok"></i></a>
                <a class="social header-footer-icon" href="https://www.youtube.com/taylorswift" target="_blank"><i class="fa-brands fa-youtube"></i></a>
                <a class="social header-footer-icon" href="https://www.snapchat.com/add/taylorswift" target="_blank"><i class="fa-brands fa-snapchat"></i></a>
                <a class="social header-footer-icon" href="https://www.reddit.com/r/taylorswift" target="_blank"><i class="fa-brands fa-reddit"></i></a>
                <a class="social header-footer-icon" href="https://www.taylorswift.com" target="_blank"><i class="fas fa-bolt"></i></a>
            </div>
            <div class="copyright">
                <i class="fa-regular fa-copyright"></i> 2023 Corey Shurdington 
            </div>
        </footer>
    </div>
    <!--Link to the js document-->
    <script src="../Script/darkmode.js"></script>
    <script src="../Script/games.js"></script>
    <script src="../Script/project.js"></script>
    <script src="../Script/script.js"></script>
    <!--Make It Blue Code Because I Couldn't Get It Working Anywhere Else-->
    <script>
        const uploadDropArea = document.getElementById("upload-drop-area");
        const fileInput = document.getElementById("file-input");
        const filteredImage = document.getElementById("filtered-image");
        const downloadButton = document.getElementById("download-button");
        const saveToPhotosMobileButton = document.getElementById("save-to-photos-mobile-button");
    
        uploadDropArea.addEventListener("click", () => {
            fileInput.click();
        });
    
        fileInput.addEventListener("change", (e) => {
            const files = e.target.files;
            if (files.length > 0) {
                handleImageFile(files[0]);
            }
        });
    
        uploadDropArea.addEventListener("dragover", (e) => {
            e.preventDefault();
            uploadDropArea.classList.add("drag-over");
        });
    
        uploadDropArea.addEventListener("dragleave", (e) => {
            e.preventDefault();
            uploadDropArea.classList.remove("drag-over");
        });
    
        uploadDropArea.addEventListener("drop", (e) => {
            e.preventDefault();
            uploadDropArea.classList.remove("drag-over");
    
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleImageFile(files[0]);
            }
        });
    
        function handleImageFile(file) {
            const reader = new FileReader();
    
            reader.onload = function (event) {
                const img = document.createElement("img");
                img.src = event.target.result;
    
                img.onload = function () {
                    const canvas = document.createElement("canvas");
                    const context = canvas.getContext("2d");
                    canvas.width = img.width;
                    canvas.height = img.height;
    
                    context.drawImage(img, 0, 0);
    
                    const imageData = context.getImageData(0, 0, canvas.width, canvas.height);
                    const data = imageData.data;
    
                    const contrastFactor = 2.5;
                    for (let i = 0; i < data.length; i += 4) {
                        const average = (data[i] + data[i + 1] + data[i + 2]) / 3;
                        const contrasted = (average - 128) * contrastFactor + 128;
                        data[i] = contrasted;
                        data[i + 1] = contrasted;
                        data[i + 2] = contrasted;
                    }
    
                    applyDuotoneEffect(data, canvas.width, canvas.height);
    
                    context.putImageData(imageData, 0, 0);
    
                    filteredImage.innerHTML = "";
                    filteredImage.appendChild(canvas);
    
                    downloadButton.style.display = "block";
    
                    downloadButton.addEventListener("click", () => {
                        const canvasDataURL = canvas.toDataURL("image/jpeg", 0.8); // Use image/jpeg format with quality parameter
                        downloadButton.href = canvasDataURL;
                        downloadButton.download = "1989-blue-filtered-image.jpg"; // Change the file extension to .jpg
                                        
                        setTimeout(() => {
                            if (!downloadButton.href.includes("image/jpeg") && /Mobi|Android/i.test(navigator.userAgent)) {
                                saveToPhotosMobileButton.style.display = "block";
                            }
                        }, 1000);
                    });

                    saveToPhotosMobileButton.style.display = "block";
                    saveToPhotosMobileButton.addEventListener("click", () => {
                        const canvasDataURL = canvas.toDataURL("image/jpeg", 0.8); // Convert canvas data to a JPEG data URL
                        const blob = dataURLtoBlob(canvasDataURL);
                        const blobUrl = URL.createObjectURL(blob);
                        navigator.share({
                            files: [new File([blob], "1989-blue-filtered-image.jpg", { type: "image/jpeg" })],
                            url: blobUrl,
                        });
                    
                        // Clean up the object URL after sharing
                        URL.revokeObjectURL(blobUrl);
                    });
                    
                    function dataURLtoBlob(dataURL) {
                        const arr = dataURL.split(",");
                        const mime = arr[0].match(/:(.*?);/)[1];
                        const byteString = atob(arr[1]);
                        const arrayBuffer = new ArrayBuffer(byteString.length);
                        const intArray = new Uint8Array(arrayBuffer);
                        for (let i = 0; i < byteString.length; i++) {
                            intArray[i] = byteString.charCodeAt(i);
                        }
                        return new Blob([intArray], { type: mime });
                    }
                };
            };
    
            reader.readAsDataURL(file);
        }
    
        const applyDuotoneEffect = (data, width, height) => {
            const lightColor = { r: 154, g: 184, b: 207 };
            const darkColor = { r: 0, g: 5, b: 6 };
    
            for (let i = 0; i < data.length; i += 4) {
                const grayscale = (data[i] + data[i + 1] + data[i + 2]) / 3;
                const ratio = grayscale / 255;
    
                const vibrancy = 0.1;
    
                data[i] = (ratio * lightColor.r + (1 - ratio) * darkColor.r) * (1 + vibrancy);
                data[i + 1] = (ratio * lightColor.g + (1 - ratio) * darkColor.g) * (1 + vibrancy);
                data[i + 2] = (ratio * lightColor.b + (1 - ratio) * darkColor.b) * (1 + vibrancy);
            }
        };
    </script>    
    </body>
</html>